# 开发任务清单（调整版）

基于最新补充要求（评分规则、题库导入与管理修正、LLM服务与文案风格、同年定义与云端化建议），本清单在原版“开发任务清单.md”的基础上进行更新升级，用于指导后续实现与验收。

## 1. 变更摘要

- 评分口径全面改为“按题目分值与得分率计算”，雷达图与详细分析均以“得分率（%）”展示，不再以正确率展示。
- 单选/多选题分值按难度分档：单选（易1分/中1.5分/难2分），多选（易2分/中3分/难4分）。
- 详细分析模块由“出题数/正确数/正确率”改为“总分/得分/得分率”，并以红黄绿灯标识（≥80%绿、<60%红、其余黄）。
- 题库导入与管理修正：场景题的多选题为5个选项（A~E），非场景题多选为4个选项；解析与生成需按题型与场景属性正确设置选项数。
- LLM服务采用 QWEN-plus（阿里云百炼兼容模式），用于“成长信”生成；文案风格要求偏暖、鼓励型，并在末尾增加鼓励与期盼段落。
- “同年”定义为测评完成时间的年份，用于双雷达线的同职级同年平均值对比。
- 云端迁移建议提供“低成本、低运维”方案，支持结果写入与聚合统计的最小后端。

## 2. 技术方案与文件改动点

### 2.1 评分与结果结构（核心）

- 在 QuestionContext.jsx 的 submitQuiz 中：
  - 新增题目分值计算：
    - 单选：易=1，中=1.5，难=2；
    - 多选：易=2，中=3，难=4；
    - 正确判定：单选严格匹配；多选需与正确答案数组完全一致（忽略顺序）。
  - 聚合两个总量：totalPossibleScore（总可得分）与 earnedScore（实际得分）。
  - 计算总体得分率：scoreRate = earnedScore / totalPossibleScore × 100，用于雷达图“总分”显示（示例：95.5/105≈90.95，页面可按90或90.9展示）。
  - 以能力与子能力维度聚合：
    - 每个能力与子能力存储 { totalScore, earnedScore, scoreRate }；
    - 结果结构新增 analysis.capabilities 与 analysis.subCapabilities；
  - 结果结构补充 userInfo（姓名、渠道、职级）、completedAt（时间戳/ISO），便于“同年”筛选与聚合。

- 在 pages/Results.jsx：
  - 雷达图以“得分率（%）”展示各能力值；
  - 双雷达线：当前用户得分率 vs 同职级、同年所有结果的平均得分率；
  - 新增“详细分析模块”：展示每个子能力的总分/得分/得分率，并以红黄绿灯显示（≥80%绿、<60%红、其它黄）。
  - 顶部显著说明：“解析仅限场景题（前30题）”。

- 在 pages/Review.jsx：
  - 展示多选题答案（用户与正确答案）；
  - 仅展示场景题；
  - 文案优化与结构化解析一致。

### 2.2 题库导入与管理修正（统一解析库）

- 新增 src/utils/questionBankImporter.js，统一解析/验证/报告生成：
  - 解析题型（single/multiple）、难度（易/中/难）、渠道、能力与子能力（支持 X.Y 或 X.Y.Z 格式）；
  - 根据“场景题/非场景题”与题型设置选项数：
    - 场景题的多选：5个选项（A~E）；
    - 非场景题的多选：4个选项（A~D）；
  - 输出题目对象需包含 { type, difficulty, capabilityKey, capabilityName, subCapabilityKey, subCapabilityName, options[], correctAnswers[] }。

- QuestionBankImporter.jsx 与 scripts/importFullQuestionBank.js 改为引用统一解析库；修正此前将多选答案选项数默认设为4的错误；导入报告统计按“题型与场景属性”校验选项数正确性。

### 2.3 能力清单统一

- 以“KO能力说明”为最终标准，同步 CAPABILITIES 常量与展示名称（示例：全域洞察力、方案规划力、故事沟通力、卖进谈判力、客户发展力、卓越执行力、战略领导力）；
- 解析库与结果页均使用同一映射；
- 旧数据迁移：为历史结果补充缺失的 position（职级）与能力映射（如发现旧key）。

### 2.4 LLM 服务与“成长信”生成

- 新增 src/utils/aiService.js：封装 QWEN-plus 生成接口与本地规则化降级策略；
- 配置（兼容 OpenAI SDK）：

```js
import OpenAI from "openai";

const openai = new OpenAI({
  apiKey: process.env.DASHSCOPE_API_KEY, // 或使用你提供的API Key
  baseURL: "https://dashscope.aliyuncs.com/compatible-mode/v1"
});

export async function generateGrowthLetter(payload) {
  const { name, position, channel, year, capabilitySummary, suggestions } = payload;
  const system = "你是一位温暖且专业的成长教练，擅长将业务评估转化为鼓励型、可落地的成长建议。";
  const user = `请为测评者生成一封“来自未来的自己”的成长信。要求：\n1) 用中文，语气温暖、鼓励；\n2) 结构包含：亮点、能力缺口、2~3项最小化行动、鼓励与期盼结语；\n3) 根据TA的能力得分率与子能力表现写出具体建议；\n4) 避免过度品牌化风格。\n\n测评信息：\n姓名：${name}；渠道：${channel}；职级：${position}；年份：${year}。\n能力总结：${JSON.stringify(capabilitySummary)}\n建议线索：${JSON.stringify(suggestions)}`;

  try {
    const completion = await openai.chat.completions.create({
      model: "qwen-plus",
      messages: [
        { role: "system", content: system },
        { role: "user", content: user }
      ]
    });
    return completion?.choices?.[0]?.message?.content || "";
  } catch (e) {
    // 降级：基于得分率的规则化生成简短成长信
    return `亲爱的${name}：\n\n从你的评估结果来看，你在以下方面表现突出：${Object.keys(capabilitySummary).filter(k=>capabilitySummary[k].scoreRate>=80).join("、")}。\n需要重点提升的是：${Object.keys(capabilitySummary).filter(k=>capabilitySummary[k].scoreRate<60).join("、") || "无明显短板"}。\n接下来建议你在2~3项最小化行动上持续前进，例如：围绕最低分子能力设置每周一次复盘、设计一项场景演练、与同事共创一页策略卡。\n\n保持热爱与耐心，未来的你正在为今天的努力点赞。期待你的每一次小进步，终将汇成大成就！\n`;
  }
}
```

- 安全建议：API Key通过环境变量注入；前端调用走后端代理或云函数，避免在浏览器暴露密钥。

#### 2.4.1 快速交付演示版（LLM成长信生成）实施步骤

**目标**
- 在不改动后端的前提下，用最短路径集成交付演示版的“成长信”生成功能，便于客户快速体验。
- 使用 QWEN-plus（阿里云百炼兼容模式）生成成长信；提供规则化降级生成，确保“有内容可用”。
- 本阶段允许“API Key 直连（硬编码或本地环境变量）”，后续再升级到 Cloudflare Workers 代理隐藏密钥。

**数据传输方案**（从评估结果到提示词输入）
- 数据来源：提交测评后的统一结果对象（localStorage: coca_cola_results），或 QuestionContext 内最新一次结果。
- 数据抽取与结构化映射（GrowthLetterPayload）：
  - name：测评者姓名（来自 userInfo）
  - position：职级（经理/主管/销售代表）
  - channel：渠道（CVS、E&D、大卖场/超市、电商、特殊渠道）
  - year：completedAt 的年份（同年聚合用）
  - abilities：数组（能力维度得分率），每项包含：
    - code：子能力编码（如 1.1、2.3）
    - name：子能力名称（与展示一致）
    - score：该维度的 earnedScore
    - total：该维度的 totalPossibleScore
    - percentage：scoreRate 的整数（Math.round）
  - strengths：按 percentage 从高到低选取前3项子能力名称
  - improvements：按 percentage 从低到高选取2项子能力名称
  - writingHints：可选的写作提示（如：希望更鼓励、更具体、结尾加“期盼与鼓励”）
- 说明：
  - 选择“子能力维度”作为 abilities 的主输入
  - 保持子能力名称与“KO能力说明”一致，避免提示词中出现不一致的标签。

**提示词与消息构造**（对接 assets/Qwen-Plus生成个性化信函的完整提示词.md）
- system 消息：保持为“温暖、专业的成长教练”，避免品牌化色彩。
- user 消息：引用上述 GrowthLetterPayload，将其嵌入提示词的“写作流程与四段结构”（参考该文件的写作思路 52-98 行），明确四段的目标与内容要点。
- 控制长度：建议控制 user 消息文本在 2,000 4,000 tokens 以内（能力列表最多 32 项，必要时做摘要），输出建议 600 1000字。

**接入方式**（Node/OpenAI SDK 兼容模式）
- 使用 Node.js OpenAI SDK（兼容百炼），配置如下（两种供演示选择）：
  - 方案A（演示最快）：硬编码 API Key 到前端或本地 Node 代理（风险：密钥暴露，仅用于本地或内网演示）。
  - 方案B（推荐演示）：在仓库新增一个简易 Node 代理（本地启动），前端通过 /api/growth-letter 调用；密钥仅在本地 .env 中配置，不入库。
- 配置要点：
  - baseURL: https://dashscope.aliyuncs.com/compatible-mode/v1
  - model: qwen-plus
  - apiKey: 使用 DASHSCOPE_API_KEY 或演示时临时硬编码
- 接口约定（本地代理）：
  - POST /api/growth-letter
  - 请求体：GrowthLetterPayload（见上）
  - 响应体：{ letter: string, model: "qwen-plus", usage?: { inputTokens, outputTokens, totalCost? }, meta?: { strengths, improvements } }
  - 超时与重试：超时设为 30s；失败重试 1 次（指数退避）

**前端集成与交互**
- 页面入口：Results.jsx 顶部或子能力分析模块旁，新增“生成成长信”按钮。
- 交互流程：
  1. 点击按钮后，采集最新结果并构造成 GrowthLetterPayload；
  2. 调用 /api/growth-letter，loading 态（骨架屏/旋转指示）；
  3. 成功后在弹窗或专属面板展示信函内容；支持复制、下载（.md）、导出（.txt）；
  4. 同时将 letter 写入当前结果对象（localStorage 中该条 result 的扩展字段，如 result.growthLetter），便于“历史结果”页面复用。
- 失败降级：如果接口失败或超时，自动启用“规则化降级生成”（见下一节），仍给出一封合规的短版成长信。

**降级生成**（规则化，本地，不依赖LLM）
- 语料来源：src/assets/KO销售能力评测反馈语句库.md
- 规则：
  - 优势段：从 strengths 的3项中，各取“情感连接”语句，改写为连贯的一段（150~200字）。
  - 困扰段：从 improvements 的2项中，取“困扰共鸣”语句，改为项目符号列表（每项包含两种具体情境，120~150字）。
  - 行动段：针对 improvements 的2项，取“微行动建议”，改写为两个小标题+两条具体行动（180~220字）。
  - 信心段：用“优势连接”的句式将优势与待提升能力建立联系，60~80字收尾，落款“来自未来的{姓名}”。
- 输出：中文、暖、鼓励型；保证四段结构与结尾一致；字数控制略短于 LLM 输出，保证快速显示。

**质量与验收**
- 功能验收：
  - 能从最新评估结果生成 GrowthLetterPayload；
  - LLM生成与降级生成均可成功输出；
  - UI 支持复制、下载与再次查看；
  - 失败时有明确提示与自动降级，不会空白。
- 文案验收：
  - 语言风格“暖、鼓励型”；避免品牌化；末尾有“鼓励与期盼”段落；
  - strengths 与 improvements 映射到语料库能力项一致；不出现错位能力名称。
- 性能与成本（演示阶段建议）：
  - 输入控制在 2,000 4,000 tokens；输出控制在 800 1,500 tokens；
  - 每次生成限制为一次，避免重复点击触发高并发。

**后续升级（Cloudflare Workers 代理）**
- 当进入正式外网演示或公测：
  - 将密钥从本地 .env 迁移到 Workers 环境变量；
  - 暴露 /ai/growth-letter 代理端点，前端仅调用代理；
  - 日志与限流：记录调用次数与错误；对单用户限速（如 1req/30s）。
- D1/KV 结合（可选）：
  - D1 存储结果与信函：results(id, userId, name, channel, position, completedAt, totalPossibleScore, earnedScore, analysisJSON, growthLetterText)
  - KV 缓存热门能力语句片段或 LLM 输出，降低重复生成成本。

**开发清单（本阶段落地到具体文件）**
- 新增/完善 src/utils/aiService.js：封装 chat.completions 调用与降级生成逻辑；导出 generateGrowthLetter(payload)。
- Results.jsx：
  - 增加“生成成长信”按钮与弹窗/面板；
  - 集成 aiService.generateGrowthLetter；将输出写回 localStorage 的该条结果。
- 文档更新：
  - IMPORT_GUIDE.md 与 README 增补“成长信生成功能”与“快速演示注意事项”（密钥暴露、降级策略、输出风格要求）。

**需要你确认的事项**
- 生成入口位置：你更倾向于在 Results.jsx 顶部（与雷达图同区）还是在“详细分析模块”下方？
    - 我建议在顶部，因为“详细分析模块”下方
- abilities 输入维度：是采用“能力维度”还是“子能力维度”作为提示词主干？当前我更建议“能力维度”（更稳妥，文本更精炼），你是否同意？
    - abilities 输入维度使用“子能力维度”作为提示词主干
- 密钥使用方式：快速演示阶段是否接受“前端硬编码”（最省事，但风险高）？还是采用“本地 Node 代理”（推荐，安全性更好，操作不复杂）？
    - 我建议采用“本地 Node 代理”
- 输出长度偏好：你更希望每封信控制在约800 1200字，还是更精简到约600 800字？我会据此调整消息长度与截断策略。
    - 我建议每封信控制在约600 1000字
- 是否需要把生成的成长信落库到结果对象中（localStorage），以便“历史结果”页直接查看与导出？
    - 我建议把生成的成长信落库到结果对象中，以便“历史结果”页直接查看与导出
- UI 呈现样式：弹窗（Modal）还是单独的“成长信”页？是否需要“复制到剪贴板”“下载.md/.txt”“一键分享（后续）”？
    - 我建议直接在“详细分析模块”下方展示完整的信函正文。字体请使用手写体
    - 在信函的正下方需要一个“下载为txt文件”按钮

**补充说明**
- 本阶段以“快速交付演示版”为目标，优先保证“可用性与输出质量”；安全与密钥管理在下一阶段（Workers 代理）完善。
- 若你希望同时准备一个命令行脚本（node main.js）用于离线批量生成示例信函，也可在 aiService 基础上追加 CLI（可在后续确认后安排）。

### 2.5 同年与双雷达线聚合

- 定义：同年=结果 completedAt 的年份；
- 聚合规则：同职级（position）+同年筛选所有结果，按能力维度计算得分率均值；
- Results.jsx 中雷达图两条线：用户得分率 vs 聚合均值；空数据时隐藏均值线并提示。

### 2.6 键名与数据迁移（健壮性）

- Context 初始化时对 localStorage 进行键名兼容迁移（旧键 testResults → 新键 coca_cola_results）；
- 提交后写入统一键名并在控制台输出校验日志；
- 结果未找到时的回退与提示优化。

### 2.7 文案与风格

- 成长信文案：整体暖、鼓励型；每封信末尾增加“鼓励与期盼”段落；
- 页面提示语与模块标题统一“非品牌化、专业友好”风格；
- 参考示例图片的信封样式仅作灵感，实际呈现以可读性为主。

## 3. 具体开发任务清单（按优先级）

### A. 高优先级（立即实施）

1) 评分规则落地与结果结构调整
- 更新 submitQuiz：引入分值表、得分率计算、子能力聚合；
- 结果结构新增 analysis.capabilities/subCapabilities、userInfo、completedAt；
- 回归测试：单选/多选判定、分值正确累计、示例对照（95.5/105≈90.95）。

2) Results.jsx 增强
- 雷达图改用得分率；
- 双雷达线（用户 vs 同职级同年均值）；
- 详细分析模块显示总分/得分/得分率与红黄绿灯；
- 顶部说明“解析仅限场景题（前30题）”。

3) Review.jsx 优化
- 多选题展示与高亮；
- 仅解析场景题；
- 文案与结构统一。

4) 题库导入修正与统一解析库
- 新建 utils/questionBankImporter.js；
- 修正多选选项数（场景5、非场景4）；
- QuestionBankImporter.jsx 与 importFullQuestionBank.js 改造为统一依赖；
- 导入报告增加“题型×场景属性×选项数”一致性校验。

5) 键名兼容与迁移
- Context 初始化迁移旧键；
- 提交写入统一键名；
- 异常回退与提示。

### B. 中优先级（完善体验与价值）

6) 能力清单统一与旧数据映射
- 同步“KO能力说明”至 CAPABILITIES 常量；
- 旧结果能力key映射修复、补齐 position。

7) LLM 集成与成长信生成
- 新增 aiService；
- 生成策略：LLM优先、本地规则化降级；
- 页面入口与下载导出（Markdown/PNG）。

8) 历史结果页面与筛选
- “我的测评历史”页面（按时间/渠道/职级筛选）；
- 趋势折线图（得分率随时间）。

9) 管理员聚合统计
- 职级×渠道×年份聚合表；
- 能力/子能力维度得分率均值与分布；
- 时间范围过滤。

### C. 低优先级（预埋与云端化）

10) 云端化最小后端（推荐方案）
- 方案一（优先，低成本）：Cloudflare Workers + D1（SQLite）/KV，提供 /results 写入与查询、聚合统计；免服务器、免费额度充足，易部署；
- 方案二：Supabase（Postgres）+ Edge Functions，开发效率高，免费层适合PoC；
- 方案三：Vercel + Neon（Postgres）+ Serverless Functions，前端同仓库部署便捷。
- 前端 data service 适配：local（默认）/cloud（env切换）。

11) 自动化测试与演示数据
- 单元测试：分值计算、得分率、聚合均值、导入解析；
- 集成测试：生成结果—展示—回顾—导出闭环；
- 准备场景化多选5项与非场景多选4项的对照数据集。

## 4. 验收标准（关键指标）

- 分值计算：单选与多选各难度分值正确累计；
- 得分率：总体与各能力、子能力得分率与示例一致；
- 红黄绿灯：≥80%绿、<60%红、其他黄；
- 雷达图：显示用户得分率与同职级同年均值两条线；
- 题库导入：场景多选=5项；非场景多选=4项；解析一致性通过；
- 结果保存：localStorage 键统一为 coca_cola_results，旧键自动迁移；
- 成长信：LLM生成成功；降级策略可用；文案符合“暖、鼓励型”与末尾鼓励段；
- 历史与管理员页：筛选、聚合正确；
- 文档更新：IMPORT_GUIDE.md、README、能力说明与统计口径（明确“得分率”）。

## 5. 依赖与协作事项（你已提供/需确认）

- LLM配置：
  - 模型：qwen-plus；
  - Base URL：`https://dashscope.aliyuncs.com/compatible-mode/v1`；
  - API Key：建议通过环境变量 DASHSCOPE_API_KEY 注入，避免在前端暴露。
- 能力清单：以“KO能力说明”为准；
- 同年：以 completedAt 年份计算；
- 云端方案：首选 Cloudflare Workers + D1/KV（最低成本与运维门槛）；也可使用 Supabase 或 Vercel + Neon。
- 文案风格：偏暖、鼓励型；每封信末尾需有“鼓励与期盼”的结语段。

## 6. 后续里程碑

- M1（评分与展示）：完成评分规则、结果结构、Results/Review增强、键名迁移与验收。
- M2（导入统一）：落地统一解析库、修正选项数、导入报告一致性校验。
- M3（成长信）：LLM集成与降级策略、下载导出、文案校验。
- M4（历史与聚合）：历史列表、管理员统计、筛选与可视化。
- M5（云端化）：最小后端与前端双模式切换、基础监控与告警。

## 7.后续补充信息
- 雷达图显示规则：得分率统一“取整”（四舍五入到整数值）。聚合均值与个人得分率都按整数显示。
- 职级枚举（position）：经理、主管、销售代表（仅这三项，前端输入与云端聚合严格校验）。
- 渠道枚举（channel）：CVS、E&D、大卖场/超市、电商、特殊渠道（同样严格校验）。
- 成长信代理：同意使用本地代理（Node/Workers）隐藏密钥。前端不直接暴露 DASHSCOPE_API_KEY。
- Cloudflare 账号与 D1/KV：你研究后告知我；在此之前，我会先把前端与本地代理对接完成，并预留 Workers 端点。
- 环境变量与密钥注入：你研究后告知我；我将提供两套示例（NodeeWorkers）以便你参考。

## 8.执行计划与交付物
**第1阶段**（T1：评分与结果结构，已完成初版）
- 引入分值表：单选（易1/中1.5/难2），多选（易2/中3/难4）。【已实现】
- 得分率计算：总体与能力、子能力维度聚合；在结果结构中新增 analysis.capabilities/subCapabilities、userInfo、completedAt。【已实现】
- 取整显示：所有展示用 Math.round，内部计算保留浮点以避免累计误差。【数据结构已提供 raw/rounded，UI 取整将于 T2 完成】
- 兼容与迁移：testResults→coca_cola_results 键名迁移与日志校验。【已实现】

**第2阶段**（T2：Results.jsx 增强）【已完成前端初版】
- 雷达图改为显示整数得分率。【已实现，统计范围：整套题（60题）】
- 双雷达线：同职级同年聚合均值（整数）。【已实现，本地聚合自 coca_cola_results，缺数据时显示提示】
- 详细分析模块（子能力）：总分/得分/得分率（整数），红黄绿灯阈值≥80绿，<60红，其余黄。【已实现，统计范围：整套题（60题）】
- 顶部说明“解析仅限场景题（前30题）”。【已移至 Review.jsx，仅在“查看答题正确答案”页面显示】

**第3阶段**（T4：统一解析库 + 多选选项数修正）
- 新建 src/utils/questionBankImporter.js，统一解析题型、难度、能力/子能力。【搁置，不调整】
- 选项数规则：场景题的多选=5项（A E），非场景多选=5项（A E）或4项（A D）。【已实现】
- 改造 QuestionBankImporter.jsx 与 scripts/importFullQuestionBank.js，导入报告新增一致性校验。【搁置，不调整】

**第4阶段**（T6：LLM 代理与成长信生成）
- 本地代理（Node）或 Workers 代理封装 /ai/growth-letter，前端仅调用代理。
- 风格：暖、鼓励型；固定结尾“鼓励与期盼”段落；失败降级为规则化生成。

**第5阶段**（T8：云端最小后端—方案一）
- 在你开通 Cloudflare 后，我将交付 Workers + D1/KV：
  - D1 表设计（建议）：results(id, userId, name, channel, position, completedAt, totalPossibleScore, earnedScore, analysisJSON)，索引：completedAt、position、channel。
  - KV 用于缓存聚合均值（key：year:position:channel）。
  - API：POST /results、GET /results/:id、GET /results?userId=…、GET /stats/averages?year=YYYY&position=经理&channel=CVS。
- 前端 data service 支持 local/cloud 模式切换（env 标记）。

**里程碑与交付节奏**
- M1（本周）：完成 T1 + T2 初版（含页面取整显示），提交预览与验收项。
- M2（下周前半）：完成 T4（解析库统一与选项数修正）+ T6（本地代理与成长信）。
- M3（下周后半，取决于你的 Cloudflare 准备）：完成 T8（Workers+D1/KV 最小后端）与前端切换；提供部署与密钥指南。
- 其后逐步推进 T3/T7/T9/T10

——以上内容将作为后续开发与验收的权威参考。如需补充，请在此文件基础上继续迭代。

## 9. 当前进度更新（截至 2025-11-10）

本节汇总近期已完成的改动与里程碑达成情况，便于外部试用与验收对齐。

### 9.1 已完成（代码与 UI 层）
- Results.jsx 页面改动：
  - 已移除“改进建议”模块（避免与成长信重复）。
  - 成长信在进入结果页后自动生成，取消“生成成长信”按钮，仅保留“下载为 txt 文件”按钮；自动生成同时写回当前结果对象（localStorage: coca_cola_results）。
  - 优势/待提升能力的选择规则已完善：
    - 优势（3项）：若得分率并列最高，按绝对得分优先；否则按得分率→绝对得分→题分值排序。
    - 待提升（2项）：若得分率并列最低，按题分值优先；否则按得分率→题分值→绝对得分排序。
  - 显示层统一按“得分率（%）”取整展示，内部保留浮点计算确保累计准确。
- 登录页与首页品牌元素：
  - 登录页、Dashboard 首页与 Navbar 左上角的“CC”圆形标识已统一替换为可口可乐瓶盖图片（src/components/CocaColaBottleCap.jsx，素材：src/assets/images/coca-cola-cap.png）。
  - 登录页已移除管理员/销售测试账号与密码的展示段落。
- 预览验证：开发服务器预览通过（http://localhost:5173/），登录页、首页与结果页交互验证未见错误；建议在终端同时观察构建日志以确保无新的告警。

### 9.2 已完成（数据与计算口径）
- 评分规则与数据结构（T1）已落地：
  - 单选/多选按难度分值累计；总体与能力/子能力维度聚合得到 { totalScore, earnedScore, scoreRate }。
  - 结果对象补充 userInfo、completedAt；localStorage 键统一为 coca_cola_results（兼容迁移自 testResults）。
- 展示与分析（T2）前端初版已完成：
  - 雷达图以“得分率（%）”展示，取整显示；
  - 双雷达线：同职级同年聚合均值与个人得分率对比（缺数据时提示并隐藏均值线）；
  - 子能力详细分析模块含红黄绿灯阈值（≥80 绿、<60 红、其它黄）。

### 9.3 里程碑达成情况
- M1（评分与展示）— 已完成：
  - 评分规则、结果结构、Results/Review 增强与键名迁移落地；展示层统一得分率取整。
- M2（导入统一）— 部分完成：
  - 多选题选项数规则已修正并在前端体现；统一解析库（questionBankImporter.js）与导入报告一致性校验暂搁置，待后续合并。
- M3（成长信）— 演示版已可用：
  - 结果页自动生成成长信与下载 txt；降级生成策略已预埋；本地 Node/Workers 代理与密钥隐藏机制待实施。
- M4/M5（历史与聚合、云端化）— 待实施：
  - 历史列表、管理员聚合统计与最小后端（Workers + D1/KV）将在你的云端账号准备完成后推进。

### 9.4 后续重点与风险提示
- 建议尽快引入本地/云端代理以隐藏 DASHSCOPE_API_KEY，避免浏览器直连带来的安全与配额风险。
- 题库统一解析库与导入一致性校验建议在 M2 收尾阶段完成，以确保 GH Pages 或后端模式下的数据一致性。
- 若改为 GitHub Pages 试用，请在构建前设置 vite.config.ts 的 base（示例：base: "/cbtn/"），并采用“公共 JSON 题库”方案或“内置数据打包”方案之一，详见部署与题库发布建议。